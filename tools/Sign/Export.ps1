# FILE: Export.ps1
# Author: Heath Stewart
# Version: 0.1
#Requires -Version 1.0

param(
	$Path = $(throw "USAGE: Export -Path <path>")
)
process
{
	$cert = dir cert:\CurrentUser\My -codesign | ? { $_.Subject -match "PowerShell" }
	$ca = dir cert:\CurrentUser -recurse | ? { $_.Subject -match $cert.Issuer }

	$pfx = new-object System.Security.Cryptography.X509Certificates.X509Certificate2Collection
	$pfx.Add($ca)
	$pfx.Add($cert)

	new-item -path . -name $Path -type file -force
	$pfx.Export("Pkcs12") | set-content -encoding byte $Path
}

# SIG # Begin signature block
# MIIPMgYJKoZIhvcNAQcCoIIPIzCCDx8CAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUusk8F/ebD6zwtnphO9TWqHel
# EvSgggvCMIICMzCCAaCgAwIBAgIQRWUfgbRh77tJlpFkzDw+SjAJBgUrDgMCHQUA
# MCQxIjAgBgNVBAMTGUNvZGVQbGV4IENlcnRpZmljYXRlIFJvb3QwHhcNMDcxMjAz
# MDQ0OTE2WhcNMzkxMjMxMjM1OTU5WjAkMSIwIAYDVQQDExlDb2RlUGxleCBDZXJ0
# aWZpY2F0ZSBSb290MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCdB8oVNlXr
# gZzdAWPmEN4MOhE468btg6CI9TJa53F0zgMSXOg0Qptj5F/R4tv4EeMJkK8Vpgc6
# 5ouLUKVk9JCElcozkeS7FPZFhF8jBYlFiPZKrLYrtykRP1c9ZhqJKQ+dDoUcVkEZ
# 0Yh4yylVLoAqMZMsNR2x26UvTN29Au1eCwIDAQABo24wbDATBgNVHSUEDDAKBggr
# BgEFBQcDAzBVBgNVHQEETjBMgBAAEiMpL26o4S1u6qbNWCt+oSYwJDEiMCAGA1UE
# AxMZQ29kZVBsZXggQ2VydGlmaWNhdGUgUm9vdIIQRWUfgbRh77tJlpFkzDw+SjAJ
# BgUrDgMCHQUAA4GBAEEmVQYs3fW25H4LGC53VoviMjouQuuhUOvJYdxHcF+g+8pV
# MqkZHvncUAEof+e+f8io/Yexx2Vhh77hIAalqewOknmMsC4kYXYz2WYdTj49gI+M
# ++c0KvH0VfAioiOuHOcA82OLtzr8NN0tvrbmWpe4WbQ2zfIOvbqzAUGT22BpMIIC
# QTCCAa6gAwIBAgIQWf/S08nL4blMzQ9wiqCD7TAJBgUrDgMCHQUAMCQxIjAgBgNV
# BAMTGUNvZGVQbGV4IENlcnRpZmljYXRlIFJvb3QwHhcNMDcxMjAzMDQ1MjA4WhcN
# MzkxMjMxMjM1OTU5WjAyMTAwLgYDVQQDEydXaW5kb3dzIEluc3RhbGxlciBQb3dl
# clNoZWxsIEV4dGVuc2lvbnMwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALL5
# DWvPtHwMNl13PCJOlN1DEnsKctJ7nhP08ZkPJ3hHH9kaYqAFtyhFZvvR8fUA/JLg
# LFNe6RObF+vew7dXEb5+DpzWhmqqHPu26MbioYmFCzNKeV6r3B11IKBV9Iybe1rY
# vqPB1zgrm6KTEOOJsEg9xiU/QGpUbZ5pzoy8MlbXAgMBAAGjbjBsMBMGA1UdJQQM
# MAoGCCsGAQUFBwMDMFUGA1UdAQROMEyAEAASIykvbqjhLW7qps1YK36hJjAkMSIw
# IAYDVQQDExlDb2RlUGxleCBDZXJ0aWZpY2F0ZSBSb290ghBFZR+BtGHvu0mWkWTM
# PD5KMAkGBSsOAwIdBQADgYEAhyRUNoDmdr+rA/bz9UUG6wyTMEEe0IG9s30ijn/d
# to7Wm3UO6hTdTLbt0gZbUlwIBnFtSwQr0Nor3dhdNe6gQn66dGtzLrx84HpTt7e9
# Hy0AxmSqwEDXfEY2piwpbvTVcettzjOX2oSHpPjRyrO8Gs9KwJ2xS46gL6jcvyFa
# wL4wggN6MIICYqADAgECAhA4Jdf6+GGvnvSQ5ya11lrVMA0GCSqGSIb3DQEBBQUA
# MFMxCzAJBgNVBAYTAlVTMRcwFQYDVQQKEw5WZXJpU2lnbiwgSW5jLjErMCkGA1UE
# AxMiVmVyaVNpZ24gVGltZSBTdGFtcGluZyBTZXJ2aWNlcyBDQTAeFw0wNzA2MTUw
# MDAwMDBaFw0xMjA2MTQyMzU5NTlaMFwxCzAJBgNVBAYTAlVTMRcwFQYDVQQKEw5W
# ZXJpU2lnbiwgSW5jLjE0MDIGA1UEAxMrVmVyaVNpZ24gVGltZSBTdGFtcGluZyBT
# ZXJ2aWNlcyBTaWduZXIgLSBHMjCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA
# xLXyUhW8iIZgKRZKWy9LkWuHkfM1VFg16tE2XmJNUlE0ccJ7Zh2JyN0qxGoK9jfZ
# mHSR9pKusLV2lvGpSmNFRy5rC5JOSyuM7lhKi9QH5Bos+IKqWNnNQvMtwHXejavH
# jh2abEwIlR7e2+9n4XLCScKeYDzh4r4Wo2N4aRR7rS0CAwEAAaOBxDCBwTA0Bggr
# BgEFBQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLnZlcmlzaWduLmNv
# bTAMBgNVHRMBAf8EAjAAMDMGA1UdHwQsMCowKKAmoCSGImh0dHA6Ly9jcmwudmVy
# aXNpZ24uY29tL3Rzcy1jYS5jcmwwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwDgYD
# VR0PAQH/BAQDAgbAMB4GA1UdEQQXMBWkEzARMQ8wDQYDVQQDEwZUU0ExLTIwDQYJ
# KoZIhvcNAQEFBQADggEBAFDFS8gkgN/kDSTC3hqxoQKhpoItDIMVgTcKgg4ssFoX
# YbXYBf6I2/GRkbNWGkCm65K+ODmwdTZ0OphP5De6mYnKlUIdsLnHoI1X4PrVZARC
# NU4B0TOiF8hNqifH8uGGTAI4TYN4xvxT4OvgBofdpJaeXgyY4qW+v4KFw2Dh360o
# 2MelS2Taxxtbvaw5CNU4IqEziy+Kmuu8ByE/REEJB7VlHCS8SNNEgOuhz8kCtBTP
# VMcWo4Bc+Xk+XXJ9iBeeLEOiylPOfT32Kjq4T5QApW0Kg135XlP0GLNXD3DD+/Wt
# laAOF97EFoBgyQ8rboYE8ev0eCfRBcXuNFteuUky8jMwggPEMIIDLaADAgECAhBH
# vxmV341SRkP3221IDTGkMA0GCSqGSIb3DQEBBQUAMIGLMQswCQYDVQQGEwJaQTEV
# MBMGA1UECBMMV2VzdGVybiBDYXBlMRQwEgYDVQQHEwtEdXJiYW52aWxsZTEPMA0G
# A1UEChMGVGhhd3RlMR0wGwYDVQQLExRUaGF3dGUgQ2VydGlmaWNhdGlvbjEfMB0G
# A1UEAxMWVGhhd3RlIFRpbWVzdGFtcGluZyBDQTAeFw0wMzEyMDQwMDAwMDBaFw0x
# MzEyMDMyMzU5NTlaMFMxCzAJBgNVBAYTAlVTMRcwFQYDVQQKEw5WZXJpU2lnbiwg
# SW5jLjErMCkGA1UEAxMiVmVyaVNpZ24gVGltZSBTdGFtcGluZyBTZXJ2aWNlcyBD
# QTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKnKsqTMzSCvCn2JrId1
# 8LRO8d/BD79nYb2jZBzau/nKM6uEMIlYfozba902ng+/0ex48nemfm88v5OvDbpo
# 9GyUyr1SLatIPfW21V1fGwKf+i9rHqT3o5qmGsgC4X9MUuMOYOxAHH65Dd4/x7Tf
# h71femoxLgOZgROoRyDOMXMNVy3NeDQzlRKZErneaC+q5uPCiowqw4shh2a9g1hX
# b3W/PKomh13KEBU8n4TqVMEKbsT+xUrduQcRlyJ82z4n0R547J8xyfHmIhnbxLNH
# Q5oaX6AekORe9e588X2rYgGP9U0L3tAiVqiVza6Idq7uug3z5E3ZoPtooK4UO7OH
# wbsCAwEAAaOB2zCB2DA0BggrBgEFBQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6
# Ly9vY3NwLnZlcmlzaWduLmNvbTASBgNVHRMBAf8ECDAGAQH/AgEAMEEGA1UdHwQ6
# MDgwNqA0oDKGMGh0dHA6Ly9jcmwudmVyaXNpZ24uY29tL1RoYXd0ZVRpbWVzdGFt
# cGluZ0NBLmNybDATBgNVHSUEDDAKBggrBgEFBQcDCDAOBgNVHQ8BAf8EBAMCAQYw
# JAYDVR0RBB0wG6QZMBcxFTATBgNVBAMTDFRTQTIwNDgtMS01MzANBgkqhkiG9w0B
# AQUFAAOBgQBKa/nqWMJEHDGJeZkrlr+CrAHWHEzNsIpYbt8IKaNeyMqTE+cEUg3v
# RycvADiw5MmTTprUImIV9z83IU9wMYDxiziHs+jolwD+z1WWTiTSqSdOeq63YUHz
# Ks7nydle3bsrhT61nbXZ4Vf/vrTFfvXPDJ7wl/4r0ztSGxs4J/c/SjGCAtowggLW
# AgEBMDgwJDEiMCAGA1UEAxMZQ29kZVBsZXggQ2VydGlmaWNhdGUgUm9vdAIQWf/S
# 08nL4blMzQ9wiqCD7TAJBgUrDgMCGgUAoHgwGAYKKwYBBAGCNwIBDDEKMAigAoAA
# oQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4w
# DAYKKwYBBAGCNwIBFTAjBgkqhkiG9w0BCQQxFgQUfD9JeoRFLHgxKkuI+U0eulRL
# wtcwDQYJKoZIhvcNAQEBBQAEgYBH7yyW8q7b3EZu6CVTrMShMqzQ/ZhfTpYv0iBc
# 3ClHy5XpnGxeaRMDO2Q0GXpMjSQo4E73+QEEi3GXr1nBGkQhq6n74v8SZ2+sMCoG
# v1Rq9L72bSy97V2xJs3cAYOroxQ0UJGc/Xi7xNmUEIdO5IjZRUqaSkJXl8msMUYN
# MrFXKKGCAX4wggF6BgkqhkiG9w0BCQYxggFrMIIBZwIBATBnMFMxCzAJBgNVBAYT
# AlVTMRcwFQYDVQQKEw5WZXJpU2lnbiwgSW5jLjErMCkGA1UEAxMiVmVyaVNpZ24g
# VGltZSBTdGFtcGluZyBTZXJ2aWNlcyBDQQIQOCXX+vhhr570kOcmtdZa1TAMBggq
# hkiG9w0CBQUAoFkwGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B
# CQUxDxcNMDcxMjA0MTYyNzMwWjAfBgkqhkiG9w0BCQQxEgQQTDdU1PvA8n5d0Dz7
# 4pshFDANBgkqhkiG9w0BAQEFAASBgLCVE9AKWgNYfaDOS//W5Jv0fVyvtMbjjrMf
# GN9mxnQqwEm6HPQguAfNhq6EHfRbi4qkCyFCLH5cg9OSyv18UFqMCYYLdquK2GS/
# QiYlOPiVYIIfXcUt8X/YsmDvi29FgtfzyLGUegZMXVuyL5ZeslnPJqyRD13bDvyJ
# lAAfCq5e
# SIG # End signature block
